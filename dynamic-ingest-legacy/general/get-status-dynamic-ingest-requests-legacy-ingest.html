---
title: 'Obtenir l'état des demandes'
description: 'Lorsque vous utilisez le <span translate="No">API d'ingestion dynamique</span> pour ajouter des vidéos à votre compte Video Cloud, ce que vous voulez le plus savoir, c'est quand la vidéo a été traitée et si les rendus ont été créés avec succès ou non. Ce document explique comment vous pouvez le faire en utilisant <span translate="No">API d'ingestion dynamique</span> avis. Nous fournissons également un exemple d'application de tableau de bord qui automatise le processus. Notez que ce document s'applique uniquement au système d'acquisition hérité - pour la livraison dynamique, voir <a href="/dynamic-ingest/general/get-status-dynamic-ingest-requests-dynamic-delivery.html">Obtenir l'état des demandes d'ingestion dynamique</a> '

parent: 'General Information' 
grandparent: <span translate="No">API d'ingestion dynamique</span> Disposition héritée : mise en scène
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
    <section class="bcls-section" id="dataSources">
    <h2>Obtenir les données</h2>
    
    <p>Les notifications Dynamic Ingest vous donnent toutes les informations dont vous avez besoin pour savoir quand votre vidéo est prête - il vous suffit de savoir quoi rechercher... et de définir ce que "prêt" signifie pour vos systèmes. Ce diagramme résume le flux de travail :</p>
    
    <figure class="bcls-figure"><img class="bcls-image" alt="Ingest Status Workflow" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/di-status/ingestion-status-architecture.svg" />
    <figcaption class="bcls-caption--image">Flux de travail de statut d'ingestion</figcaption>
    </figure>
    </section>
    
    <section id="Dynamic_Ingest_Notifications" class="bcls-section">
    <h2>Notifications d'ingestion dynamique</h2>
    
    <p>Le service de notification Dynamic Ingest vous envoie des notifications pour plusieurs types d'événements. Les trois qui sont les plus utiles pour déterminer quand la vidéo est « prête » sont celles qui indiquent que des rendus particuliers ont été créés, celles qui indiquent qu'un manifeste a été créé et celle qui indique que tout le traitement est terminé. Voici des exemples de chacun :</p>
    
    <h3>Notification de création de rendu</h3>
    
    <figure class="bcls-figure">
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
        "entity": "5002412132001",
        <span class="bcls-highlight">"profileRefId": "ts7",</span>
        "accountId": "57838016001",
        "entityType": "ASSET",
        <span class="bcls-highlight">"videoId": "5002361893001",</span>
        <span class="bcls-highlight">"status": "SUCCESS",</span>
        "version": "1",
        "action": "CREATE",
        "jobId": "bb316631-c58b-4bd4-a686-13c5f7a3a779"
    }</code></pre>
    
    <figcaption class="bcls-caption--image">Notification de rendu créé</figcaption>
    </figure>
    
    <p>Remarque dans cet exemple :</p>
    
    <ul>
      <li>Les <code translate="No">videoId</code> la valeur vous permet de savoir à quelle vidéo le rendu est destiné (au cas où plusieurs tâches d'ingestion seraient en cours d'exécution)</li>
      <li>Les <code translate="No">profileRefId</code> value est l'ID de référence pour le rendu spécifié dans le profil d'ingestion</li>
      <li>si la <code translate="No">status</code> la valeur est "SUCCESS", le rendu a été créé avec succès</li>
      <li>Pour un type segmenté comme HLS ou MPEG-DASH, l'existence du rendu ne le rend pas jouable - vous avez également besoin du manifeste approprié (voir l'exemple suivant). Les rendus MP4 sont lisibles dès leur création.</li>
    </ul>
    
    <h3>Notification de création de manifeste</h3>
    
    <figure class="bcls-figure">
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
        "jobId": "31f0b112-9890-4567-adb5-0f4ed1673701",
        <span class="bcls-highlight">"status": "SUCCESS",</span>
        "version": "1",
        "action": "CREATE",
        "entityType": "ASSET",
        "entity": "5002412528001",
        <span class="bcls-highlight">"videoId": "5002361895001",</span>
        <span class="bcls-highlight">"profileRefId": "HlsManifest",</span>
        "accountId": "57838016001"
    }</code></pre>
    
    <figcaption class="bcls-caption--image">Notification de manifeste créé</figcaption>
    </figure>
    
    <p>Remarque dans cet exemple :</p>
    
    <ul>
      <li>Les <code translate="No">videoId</code> la valeur vous permet de savoir à quelle vidéo le rendu est destiné (au cas où plusieurs tâches d'ingestion seraient en cours d'exécution)</li>
      <li>Les <code translate="No">profileRefId</code> value est un code spécial qui vous indique que l'actif créé était un manifeste HLS (les autres valeurs possibles sont <code translate="No">HdsManifest</code> , <code translate="No">DashManifest</code> , et <code translate="No">SmoothIsmManifest</code>)</li>
      <li>Pour HLS et HDS, un manifeste sera créé, vous verrez donc une notification. Pour DASH et SmoothIsm, deux manifestes sont créés (un pour une utilisation dans l'API Media héritée, l'autre pour l'API CMS), vous verrez donc deux notifications de ce type.</li>
      <li>Si la <code translate="No">status</code> la valeur est "SUCCESS", le manifeste a été créé avec succès</li>
      <li>Pour un type segmenté comme HLS ou MPEG-DASH, il n'y a pas d'ordre défini pour la création des rendus et du manifeste - ces rendus ne sont pas lisibles tant que les deux ne sont pas créés (ou que la vidéo n'a pas été entièrement traitée - voir l'exemple suivant).</li>
    </ul>
    
    <h3>Traitement de la notification de fin</h3>
    
    <figure class="bcls-figure">
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
        <span class="bcls-highlight">"entityType": "TITLE",</span>
        <span class="bcls-highlight">"status": "SUCCESS",</span>
        "accountId": "57838016001",
        "entity": "5002412652001",
        "action": "CREATE",
        "jobId": "3e98b3a0-f624-4f2d-81c1-4e43e1d04a0f",
        "version": "1",
        <span class="bcls-highlight">"videoId": "5002412652001"</span>
    }</code></pre>
    
    <figcaption class="bcls-caption--image">Notification de traitement terminé</figcaption>
    </figure>
    
    <p>Remarque dans cet exemple :</p>
    
    <ul>
      <li>Les <code translate="No">videoId</code> la valeur vous permet de savoir à quelle vidéo le rendu est destiné (au cas où plusieurs tâches d'ingestion seraient en cours d'exécution)</li>
      <li>Les <code translate="No">profileRefId</code> est <strong>ne pas</strong> inclus dans cette notification</li>
      <li>Si la <code translate="No">status</code> la valeur est "SUCCESS", la vidéo a été traitée avec succès</li>
    </ul>
    
    <p>Pour recevoir des notifications, vous devez inclure un champ « rappels » en vous <span translate="No">API d'ingestion dynamique</span> requêtes, pointant vers une ou plusieurs adresses de rappel :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
        "master": {
            "url": "https://s3.amazonaws.com/bucket/mysourcevideo.mp4"
        }, "profile": "high-resolution",
        <strong>"callbacks": ["http://host1/path1”, “http://host2/path2”]</strong>
    }</code></pre>
    </section>
    
    <section class="bcls-section" id="sample">
    <h2>Exemple de tableau de bord</h2>
    
    <p>Cette section explique comment les notifications peuvent être rassemblées pour créer un tableau de bord simple pour l'API Dynamic Ingest. Le gestionnaire de notifications analyse les notifications du <span translate="No">API d'ingestion dynamique</span> pour identifier le traitement des notifications complètes. Il ajoute ensuite les notifications vidéo dans un tableau d'objets pour chaque vidéo dans un fichier JSON. Le tableau de bord lui-même est une page HTML qui importe le fichier JSON pour obtenir les données de notification. Il utilise les identifiants pour faire une demande au <a href="/cms/getting-started/overview-cms-api.html">API CMS</a> pour obtenir les métadonnées de la vidéo. Vous pouvez consulter le tableau de bord <a href="//solutions.brightcove.com/bcls/di-api/di-log.html">ici</a>.</p>
    
    <p>Tous les fichiers de cette application, ainsi que les instructions de configuration de votre compte, sont dans <a href="https://github.com/BrightcoveLearning/dynamic-ingest-dashboard">ce référentiel</a>.</p>
    
    <p>Voici l'architecture de haut niveau de l'application :</p>
    
    <figure class="bcls-figure"><img class="bcls-image" alt="Ingest Dashboad Architecture" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/di-status/ingestion-dashboard-architecture.svg" />
    <figcaption class="bcls-caption--image">Ingérer l'architecture du tableau de bord</figcaption>
    </figure>
    
    <h3>Les parties de l'application</h3>
    
    <p>Le gestionnaire de notifications est intégré à PHP - il recherche le traitement des notifications complètes et ajoute l'identifiant vidéo à un tableau dans un fichier JavaScript séparé :</p>
    
    <pre class="line-numbers">
    <code class="language-php">&lt;?php // var pour consigner les erreurs, le cas échéant $problem = "No error"; // var pour stocker l'index vidéo actuel $videoIndex = -1; // récupérer les données d'entrée essayer { $json = file_get_contents('php://input'); $decoded = json_decode($json, true); } capture (Exception $e) { $problem = $e-&gt;getMessage(); echo $problem; } // obtenir le contenu du fichier de données et l'analyser essayez { $notificationData = file_get_contents('di.json'); $notificationDataDecoded = json_decode($notificationData, true); } capture (Exception $e) { $problem = $e-&gt;getMessage(); echo $problem; } if (isset($decoded["entityType"])) { $entityType = $decoded["entityType"]; // if the entity type is ASSET or TITLE, add it to notification data array if ($entityType == "ASSET" || $entityType == "TITLE") { array_push($notificationDataDecoded, $decoded); } // maintenant nous allons remplacer le contenu de di.json par ce que nous avons file_put_contents('di.json', json_encode($notificationDataDecoded)); } echo "L'application de rappel Dynamic Ingest est en cours d'exécution" ; var_dump($notificationData); ?&gt; </code></pre>
    
    <h4>Fichier JSON :</h4>
    
    <p>Le fichier JSON est initialement un tableau vide (<code translate="No">[]</code> ) - les données sont ajoutées par le gestionnaire de notification.</p>
    
    <h4>Tableau de bord</h4>
    
    <p>Le tableau de bord comprend le code HTML et JavaScript pour récupérer les données de notification et des données vidéo supplémentaires à partir du <span translate="No">API CMS</span> et écris les résultats dans un tableau :</p>
    
    <pre class="line-numbers">
    <code class="language-html" translate="No">&lt;!DOCTYPE html&gt;
    &lt;html&gt;
        &lt;head&gt;
            &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
            &lt;title&gt;Dynamic Ingest Log&lt;/title&gt;
            &lt;style&gt;
                body {
                    font-family: sans-serif;
                    margin: 5em;
                }
                .hide {
                    display: none;
                }
                .show {
                    display: block;
                }
                table {
                    border-collapse: collapse;
                    border: 1px #999999 solid;
                }
                th {
                    background-color: #666666;
                    color: #f5f5f5;
                    padding: .5em;
                    font-size: .7em;
                }
                td {
                    border: 1px #999999 solid;
                    font-size: .7em;
                    padding: .5em
                }
                .hidden {
                    display: none;
                }
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;Dynamic Ingest Log&lt;/h1&gt;
            &lt;h2&gt;Account: Brightcove Learning (57838016001)&lt;/h2&gt;
            &lt;p style="width:70%"&gt;
                Videos are listed in order of processing completion time, newest to oldest. The reference id (generated by the &lt;a href="./di-tester.html"&gt;Dynamic Ingest tester&lt;/a&gt;) is a combination of the date/time that the Dynamic Ingest job was initiated and the ingest profile that was used. You can add additional videos using the &lt;a href="./di-tester.html"&gt;Dynamic Ingest tester&lt;/a&gt;. New videos will appear in this log after processing is complete.
            &lt;/p&gt;
            &lt;p&gt;
                &lt;button id="clearLogBtn"&gt;Clear the log&lt;/button&gt;
            &lt;/p&gt;
            &lt;div id="videoLogBlock"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th&gt;Video ID&lt;/th&gt;
                            &lt;th&gt;Name&lt;/th&gt;
                            &lt;th&gt;Reference ID&lt;/th&gt;
                            &lt;th&gt;HLS Manifests Created&lt;/th&gt;
                            &lt;th&gt;HLS Renditions Created&lt;/th&gt;
                            &lt;th&gt;MP4 Renditions Created&lt;/th&gt;
                            &lt;th&gt;Processing Complete&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="logBody"&gt;&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;h4 id="loadingMessage"&gt;Loading data, please wait...&lt;/h4&gt;
            &lt;/div&gt;
            &lt;script&gt;
            var BCLS = ( function (window, document) {
                // to use another account, set the account_id value appropriately
                // the client_id and client_secret will also need to be changed in the proxy
                var my_account_id = 57838016001,
                    account_id = my_account_id,
                    logBody = document.getElementById('logBody'),
                    loadingMessage = document.getElementById('loadingMessage'),
                    clearLogBtn = document.getElementById('clearLogBtn'),
                    i = 0,
                    iMax,
                    // set the proxyURL to the location of the proxy app that makes Brightcove API requests
                    proxyURL = './brightcove-learning-proxy.php',
                    dataFileURL = './di.json',
                    videoDataArray = [],
                    requestOptions = {},
                    currentVideo,
                    currentIndex = 0;
    
                    /**
                     * Logging function - safe for IE
                     * @param  {string} context - description of the data
                     * @param  {*} message - the data to be logged by the console
                     * @return {}
                     */
                    function bclslog(context, message) {
                        if (window["console"] &amp;&amp; console["log"]) {
                          console.log(context, message);
                        }
                        return;
                    }
    
                    /**
                     * tests for all the ways a variable might be undefined or not have a value
                     * @param {*} x the variable to test
                     * @return {Boolean} true if variable is defined and has a value
                     */
                    function isDefined(x) {
                        if ( x === '' || x === null || x === undefined || x === NaN) {
                            return false;
                        }
                        return true;
                    }
    
                    /**
                     * find index of an object in array of objects
                     * based on some property value
                     *
                     * @param {array} targetArray - array to search
                     * @param {string} objProperty - object property to search
                     * @param {string|number} value - value of the property to search for
                     * @return {integer} index of first instance if found, otherwise returns null
                     */
                    function findObjectInArray(targetArray, objProperty, value) {
                        var i, totalItems = targetArray.length, objFound = false;
                        for (i = 0; i &lt; totalItems; i++) {
                            if (targetArray[i][objProperty] === value) {
                                objFound = true;
                                return i;
                            }
                        }
                        if (objFound === false) {
                            return null;
                        }
                    }
    
                    /**
                     * factory for new video objects
                     * @param {String} videoId the video id
                     * @return {object} the new object
                     */
                    function makeVideoDataObject(videoId) {
                        var obj = {};
                        obj.id = videoId;
                        obj.name = '';
                        obj.reference_id = '';
                        obj.hlsManifests = 0;
                        obj.hlsRenditions = 0;
                        obj.mp4Renditions = 0;
                        obj.complete = 'no';
                        return obj;
                    }
    
                    /**
                     * processes notification objects
                     * creates a new object in the videoDataArray if it doesn't exist
                     * and updates the videoDataArray object based on the notification
                     * @param {Object} notificationObj the raw notification object
                     */
                    function processNotification(notificationObj) {
                        var objIndex, videoObj;
                        // if notification object contains a video id, find the corresponding
                        // object in the videoDataArray or create it if it's not there
                        if (isDefined(notificationObj) &amp;&amp; isDefined(notificationObj.videoId)) {
                            objIndex = findObjectInArray(videoDataArray, 'id', notificationObj.videoId);
                            // if not found, create one
                            if (!isDefined(objIndex)) {
                                videoObj = makeVideoDataObject(notificationObj.videoId);
                                videoDataArray.push(videoObj);
                                objIndex = videoDataArray.length - 1;
                            }
                            // now update properties based on what's in the notification
                            if (notificationObj.entityType === 'ASSET') {
                                // if it's a rendition or manifest, there will be a profileRefId
                                if (isDefined(notificationObj.profileRefId)) {
                                    // see if it's an HLS manifest
                                    if (notificationObj.profileRefId === 'HlsManifest') {
                                        // increment the hls manifest count
                                        videoDataArray[objIndex].hlsManifests++;
                                    } else if (notificationObj.profileRefId.charAt(0) === 't') {
                                        // increment the hls rendition count
                                        videoDataArray[objIndex].hlsRenditions++;
                                    } else if (notificationObj.profileRefId.charAt(0) === 'm') {
                                        // increment the mp4 rendition count
                                        videoDataArray[objIndex].mp4Renditions++;
                                    }
                                }
                            } else if (notificationObj.entityType === 'TITLE') {
                                // overall processing notification - checked for SUCCESS / FAILED
                                if (notificationObj.status === 'SUCCESS') {
                                    // mark complete
                                    videoDataArray[objIndex].complete = 'yes';
                                } else if (notificationObj.status === 'FAILED') {
                                    // mark failed
                                    videoDataArray[objIndex].complete = 'failed';
                                }
                            }
                        }
                        return;
                    }
    
                    /**
                     * creates the dashboard table body
                     */
                    function writeReport() {
                        var j,
                            jMax = videoDataArray.length,
                            item,
                            t;
                        loadingMessage.textContent = 'This page will refresh in 1 minute...';
                        /* just showing HLS and MP4 renditions, because
                         * that's all that will be produced in this account,
                         * but you could modify the notification handler and
                         * this page to handle other formats
                         */
                        for (j = 0; j &lt; jMax; j++) {
                            item = videoDataArray[j];
                            if (item.id !== undefined) {
                                logBody.innerHTML += '&lt;tr&gt;&lt;td&gt;' + item.id + '&lt;/td&gt;&lt;td&gt;' + item.name + '&lt;/td&gt;&lt;td&gt;' + item.reference_id + '&lt;/td&gt;&lt;td&gt;' + item.hlsManifests + '&lt;/td&gt;&lt;td&gt;' + item.hlsRenditions + '&lt;/td&gt;&lt;td&gt;' + item.mp4Renditions + '&lt;/td&gt;&lt;td&gt;' + item.complete + '&lt;/td&gt;&lt;/tr&gt;';
                            }
                        }
                        // set timeout for refresh
                        t = window.setTimeout(init, 60000);
                    };
    
                    // function to set up the notification data request
                    function setJSONRequestOptions() {
                        submitRequest(null, dataFileURL, 'notificationData');
                    }
    
                    // function to set up video data request
                    function setVideoRequestOptions() {
                        requestOptions = {};
                        requestOptions.url = 'https://cms.api.brightcove.com/v1/accounts/' + account_id + '/videos/' + currentVideo.id;
                        submitRequest(requestOptions, proxyURL, 'video');
                    }
    
                    /**
                     * initiates the <span translate="No">CMS API</span> requests
                     */
                    function getVideoInfo() {
                        iMax = videoDataArray.length;
                        if (currentIndex &lt; iMax) {
                            currentVideo = videoDataArray[currentIndex];
                            setVideoRequestOptions();
                        } else {
                            loadingMessage.innerHTML = 'No videos have been ingested - you can add some using the &lt;a href="./di-tester.html"&gt;Dynamic Ingest tester&lt;/a&gt;';
                        }
                    }
    
                    /**
                     * make the <span translate="No">CMS API</span> requests
                     * @param {Object} options request options
                     * @param (String) url URL to send request to
                     * @param (String) type the request type
                     */
                    function submitRequest(options, url, type) {
                        var httpRequest = new XMLHttpRequest(),
                            requestData,
                            responseData,
                            videoDataObject,
                            parsedData,
                            getResponse = function () {
                                try {
                                    if (httpRequest.readyState === 4) {
                                      if (httpRequest.status === 200) {
                                        responseData = httpRequest.responseText;
                                        switch (type) {
                                            case 'notificationData':
                                            var k, kMax, dataArray;
                                            dataArray = JSON.parse(responseData);
                                            bclslog('dataArray', dataArray);
                                            // process the notifications
                                            kMax = dataArray.length;
                                            for (k = 0; k &lt; kMax; k++) {
                                                processNotification(dataArray[k]);
                                            }
                                            getVideoInfo();
                                            break;
                                            case 'video':
                                            parsedData = JSON.parse(responseData);
                                            bclslog('parsedData', parsedData);
                                            videoDataArray[currentIndex].reference_id = parsedData.reference_id;
                                            videoDataArray[currentIndex].name = parsedData.name;
                                            currentIndex++;
                                            if (currentIndex &lt; iMax) {
                                                currentVideo = videoDataArray[currentIndex];
                                                setVideoRequestOptions();
                                            } else {
                                                writeReport();
                                            }
                                            break;
                                        }
                                      } else {
                                        bclslog("There was a problem with the request. Request returned " + httpRequest.status);
                                        if (type === 'video') {
                                            setVideoRequestOptions();
                                        } else {
                                            setSourcesRequestOptions();
                                        }
                                      }
                                    }
                                  }
                                  catch(e) {
                                    bclslog('Caught Exception: ' + e);
                                  }
                            };
                        // notifications data is a special case
                        if (type === 'notificationData') {
                            // set response handler
                            httpRequest.onreadystatechange = getResponse;
                            // open the request
                            httpRequest.open("GET", url);
                            // set headers
                            httpRequest.setRequestHeader("Content-Type", "application/json");
                            // open and send request
                            httpRequest.send();
                        } else {
                            // requests via proxy
                            // set up request data
                            requestData = "url=" + encodeURIComponent(options.url) + "&amp;requestType=GET";
                            // set response handler
                            httpRequest.onreadystatechange = getResponse;
                            // open the request
                            httpRequest.open("POST", url);
                            // set headers
                            httpRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                            // open and send request
                            httpRequest.send(requestData);
                        }
                    };
    
                    // event handlers
                    clearLogBtn.addEventListener('click', function () {
                        if (window.confirm('Are you sure? This action cannot be undone!')) {
                            // if your clear-log app resides in another location, change the URL
                            window.location.href = 'clear-log.php';
                        }
                    });
    
                    // get things started
                    function init() {
                        // clear table and the video data array
                        logBody.innerHTML = "";
                        videoDataArray = [];
                        setJSONRequestOptions();
                    }
                    // kick off the app
                    init();
                })(window, document);
            &lt;/script&gt;
        &lt;/body&gt;
    &lt;/html&gt;
    </code></pre>
    
    <aside class="bcls-aside bcls-aside--tip">Il y a un choix de conception à faire ici : vous pouvez utiliser le gestionnaire de notifications ou le tableau de bord (ou une combinaison des deux) pour traiter les notifications et extraire les informations utiles. Dans ce type d'application, nous préférons garder le gestionnaire de notification simple, en l'utilisant simplement pour transmettre les données de notification, et laisser l'application cliente (dans ce cas le tableau de bord) effectuer le traitement des informations. Cela nécessite plus de traitement sur le client, mais rend le gestionnaire de notification plus réutilisable.</aside>
    
    <h4>Procuration</h4>
    
    <pre class="line-numbers">
    <code class="language-php">&lt;?php /** * brightcove-learning-proxy.php - proxy pour les API RESTful Brightcove * obtient un jeton d'accès, effectue la demande et renvoie la réponse * Accès : * URL : https://solutions.brightcove.com/ bcls/bcls-proxy/bcsl-proxy.php * (notez que vous devez *toujours* accéder au proxy via HTTPS) * Méthode : POSTER * * @poster {string} url - l'URL de la requête API * @post {string} [requestType=GET] - Méthode HTTP pour la requête * @post {string} [requestBody=null] - Données JSON à envoyer avec les demandes d'écriture * * @returns {string} $response - Réponse JSON reçue de l'API */ // En-tête d'activation CORS ("Access-Control-Allow-Origin: *"); // configurer la demande de jeton d'accès $data = array(); // // modifiez les valeurs ci-dessous pour utiliser ce proxy avec un autre compte // $client_id = "YOUR_CLIENT_ID_HERE"; $client_secret = "VOTRE_CLIENT_SECRET_ICI" ; $ chaîne_auth = "{$client_id}:{$client_secret}"; $request = "https://oauth.brightcove.com/v4/access_token?grant_type=client_credentials"; $ch = curl_init($request); curl_setopt_array($ch, array( CURLOPT_POST =&gt; TRUE, CURLOPT_RETURNTRANSFER =&gt; TRUE , CURLOPT_SSL_VERIFYPEER =&gt; FALSE, CURLOPT_USERPWD =&gt; $auth_string, CURLOPT_HTTPHEADER =&gt; array( 'Content-type: application/x-www-form-urlencoded', ), CURLOPT_POSTFIELDS =&gt; $data )); $response($ch curl_ ); curl_close($ch); // Vérifier les erreurs if ($response === FALSE) { die(curl_error($ch)); } // Décode la réponse $responseData = json_decode($response, TRUE); $access_token = $responseData["access_token"] ; // configure l'appel d'API // obtient les données si ($_POST["requestBody"]) { $data = json_decode($_POST["requestBody"]); } autre { $data = array(); } // obtient le type de requête ou par défaut GET if ($_POST["requestType"]) { $method = $_POST["requestType"]; } autre { $method = "GET"; } // récupère l'URL et les informations d'autorisation à partir des données du formulaire $request = $_POST["url"]; //envoyer la requête http $ch = curl_init($request); curl_setopt_array($ch, array( CURLOPT_CUSTOMREQUEST =&gt; $method, CURLOPT_RETURNTRANSFER =&gt; TRUE, CURLOPT_SSL_VERIFYPEER =&gt; FALSE, CURLOPT_HTTPHEADER =&gt; array( 'Content-type: application/json', " Porteur {$access_token}", ), CURLOPT_POSTFIELDS =&gt; json_encode($data) )); $response = curl_exec($ch); curl_close($ch); // Vérifier les erreurs si ($response === FALSE) { echo "Error: "+$response; die(curl_error($ch)); } // Décode la réponse // $responseData = json_decode($response, TRUE); // renvoie la réponse à l'appelant AJAX echo $response; ?&gt; </code></pre>
    
    <h4>Effacer le journal</h4>
    
    <p>Cette application PHP simple restaure simplement le fichier JavaScript à son état d'origine, en effaçant les anciens identifiants vidéo :</p>
    
    <pre class="line-numbers">
    <code class="language-php">&lt;?php $logFileLocation = "di.json"; $freshContent = array (); $encodedContent = json_encode($freshContent); file_put_contents($logFileLocation, $encodedContent); echo 'Fichier journal effacé - &lt;a href="di-log.html"&gt;retourner au tableau de bord&lt;/a&gt;' ; ?&gt; </code></pre>
    </section>
    </article>
 