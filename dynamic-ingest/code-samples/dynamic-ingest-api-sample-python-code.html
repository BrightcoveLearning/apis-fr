---
title: 'Code Python'
description: 'Cette rubrique fournit un exemple de script Python pour l'ingestion d'une vidéo à l'aide de l'API Dynamic Ingest.'

parent: 'Code Samples' 
grandparent: Dynamic Ingest API
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
    <section class="bcls-section">
    <h2 id="Introduction">introduction</h2>
    
    <p>Les API REST comme les API de la plate-forme Brightcove peuvent être utilisées avec n'importe quel langage. Le script Python inclus ici n'est qu'un exemple pour vous montrer comment les requêtes sont assemblées. Il existe un autre exemple de requête GET simple (pour l'API CMS) <a href="/cms/code-samples/cms-api-sample-python-code-get-request.html">ici</a>.</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="dependencies">Dépendances</h2>
    
    <ul>
      <li><a href="https://python.readthedocs.io/en/latest/">Demandes</a></li>
    </ul>
    </section>
    
    <section class="bcls-section" id="script">
    <h2>Script Python</h2>
    
    <p>Le code ci-dessous montre le script. Notez que pour l'utiliser, vous devrez fournir vos propres valeurs pour les éléments suivants :</p>
    
    <ul>
      <li>***ID DE COMPTE ICI**** (ligne 8)</li>
      <li>***ID CLIENT ICI**** (ligne 9)</li>
      <li>***CLIENT SECRET ICI**** (ligne 10)</li>
      <li>***TITRE DE LA VIDÉO ICI*** (ligne 27)</li>
      <li>***URL DE LA VIDÉO SOURCE ICI*** (ligne 40)</li>
    </ul>
    
    <pre class="line-numbers">
    <code class="language-python" translate="No">#!/usr/bin/env python
    
    import sys
    import requests
    import json
    import argparse
    
    pub_id = "***ACCOUNT ID HERE****"
    client_id = "***CLIENT ID HERE****"
    client_secret = "***CLIENT SECRET HERE****"
    access_token_url = "https://oauth.brightcove.com/v4/access_token"
    profiles_base_url = "http://ingestion.api.brightcove.com/v1/accounts/{pubid}/profiles"
    
    def get_access_token():
        access_token = None
        r = requests.post(access_token_url, params="grant_type=client_credentials", auth=(client_id, client_secret), verify=False)
        if r.status_code == 200:
            access_token = r.json().get('access_token')
            print(access_token)
        return access_token
    
    def create_video():
        access_token = get_access_token()
        headers = { 'Authorization': 'Bearer ' + access_token, "Content-Type": "application/json" }
    
        url = ("https://cms.api.brightcove.com/v1/accounts/{pubid}/videos/").format(pubid=pub_id)
        data = '{"name": "***VIDEO TITLE HERE***"}'
        r = requests.post(url, headers=headers, data=data)
        return r.json()
    
    def submit_pbi(video_id):
        access_token = get_access_token()
        print access_token
        headers = { 'Authorization': 'Bearer ' + access_token, "Content-Type": "application/json" }
    
        url = ("https://ingest.api.brightcove.com/v1/accounts/{pubid}/videos/{videoid}/ingest-requests").format(pubid=pub_id, videoid=video_id)
        print url
    
        data = '''{
                "master": { "url": "****SOURCE VIDEO URL HERE***" }
             }'''
        r = requests.post(url, headers=headers, data=data)
        print r.headers
        return r.json()
    
    v = create_video()
    print v
    print submit_pbi(v['id'])</code></pre>
    </section>
    </article>
 