---
title: 'Démarrage rapide: Utilisation des sorties RTMP pour les événements en direct'
description: 'Ce didacticiel vous guidera à travers la création de sorties RTMP pour configurer des événements en direct sur YouTube Live et Facebook Live.'
parent: Code Samples 
grandparent: Live API
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
<section class="bcls-section">
<h2 id="Overview">Aperçu</h2>

<figure class="bcls-figure"><img alt="general-block-diagram" title="Block diagram" src="/assets/images/live-api/18697/block-diagram-small.png" />
<figcaption class="bcls-caption--image">Diagramme</figcaption>
</figure>

<p>Ce tutoriel explique au niveau de l'API comment créer une tâche de streaming en direct dans <a href="/">Brightcove en direct</a> puis créer <a href="https://en.wikipedia.org/wiki/Real-Time_Messaging_Protocol">RTMP</a> sorties et les rediffuser sur YouTube Live et Facebook Live.</p>

<aside class="BCL-bcls-aside bcls-aside--information">Remarques:
<ul>
	<li>Pour plus d'informations sur l'utilisation des sorties RTMP dans le module Live, consultez <a href="https://live.support.brightcove.com/live-module/using-live-rtmp-outputs-stream-facebook-and-youtube.html">Utilisation des sorties RTMP en direct pour diffuser sur Facebook et YouTube</a>.</li>
  <li>Sorties RTMP <strong>Est-ce que</strong> Support <code translate="No">rtmps</code> URL - vous devez utiliser <code translate="No">rtmps</code> si la plate-forme sociale le prend en charge.</li>
  <li>Notez que Facebook a mis fin à la prise en charge de <code translate="No">rtmp</code>.streams à partir du 1er mai 2019, pour Facebook, vous <strong>DOIT</strong> utilisation <code translate="No">RTMPS</code>.</li>
  <li>Les <strong>seul format actuel pris en charge pour les URL RTMP</strong> est <code translate="No">rtmps://host:port/application/streamName</code>.</li>
</ul>
</aside>

<p>Ce tutoriel utilisera <a translate="No" href="https://general.support.brightcove.com/developer/concepts-set-curl.html">boucle</a> pour faire les requêtes API, mais vous pouvez facilement les faire dans <a translate="No" href="https://apis.support.brightcove.com/general/use-insomnia-api-requests.html">Insomnie</a> , <a translate="No" href="https://apis.support.brightcove.com/general/use-postman-api-requests.html">Facteur</a> ou d'autres clients REST à la place.</p>
</section>

<section class="bcls-section">
<h2 id="create_a_live_job">Créer un emploi en direct</h2>

<p>Tout d'abord, nous allons créer un emploi réel. Vous aurez besoin d'un <code translate="No">API-KEY</code> pour l'API en direct. Si ce n'est pas le cas et que vous souhaitez obtenir un accès, veuillez contacter votre gestionnaire de compte.</p>

<ol class="bcls-tasklist-restart">
	<li>
	<p>Copiez et collez ce qui suit <span translate="No">boucle</span> commande dans un éditeur de texte :</p>

	<pre class="line-numbers">
<code class="language-bash" translate="No">curl -X POST \
  https://api.bcovlive.io/v1/jobs \
  -H 'Content-Type: application/json' \
  -H 'x-api-key: {{bcov-live-api-key}}' \
  -d '{
    "live_stream": true,
    "region": "{{closest-region-encoder}}",
    "outputs": [{
      "label": "hls360p",
      "live_stream": true,
      "height": 360,
      "video_bitrate": 365,
      "segment_seconds": 6,
      "keyframe_interval": 60
    },
    {
      "label": "hls432p",
      "live_stream": true,
      "height": 432,
      "video_bitrate": 730,
      "segment_seconds": 6,
      "keyframe_interval": 60
    },
    {
      "label": "hls540p",
      "live_stream": true,
      "height": 540,
      "video_bitrate": 2000,
      "segment_seconds": 6,
      "keyframe_interval": 60
    },
    {
      "label": "hls720p3M",
      "live_stream": true,
      "height": 540,
      "video_bitrate": 2000,
      "segment_seconds": 6,
      "keyframe_interval": 60
    },
    {
      "label": "hls720p4.5M",
      "live_stream": true,
      "height": 540,
      "video_bitrate": 4500,
      "segment_seconds": 6,
      "keyframe_interval": 60
    }]
  }'
</code></pre>
	</li>
	<li>
	<p><strong>Remplacer:</strong></p>

	<ul>
		<li><code translate="No">{{closest-region-encoder}}</code> avec la région disponible la plus proche de votre encodeur, voir <a href="/live-api/getting-started/overview-brightcove-live-api.html#Support_aws_regions">régions disponibles les plus proches</a> à votre encodeur. Par exemple: <code translate="No">us-west-2</code></li>
		<li><code translate="No">{{bcov-live-api-key}}</code> avec votre clé API live Brightcove. Par exemple: <code translate="No">abcdfeg-this-is-a-fake-api-key-FgJajjasd12hJHsZ</code></li>
	</ul>
	</li>
	<li>Après avoir apporté ces modifications, copiez et collez le code dans Terminal ou dans l'application de ligne de commande que vous utilisez et exécutez-le.</li>
	<li>
	<p>La réponse devrait ressembler à ceci :</p>

	<pre class="line-numbers">
<code class="language-json" translate="No">{
    "id": "3b6871bf2f344acaa6b397d09b476018",
    "outputs": [... removed for simplicity ...],
    "stream_url": "rtmp://ep1-usw2.bcovlive.io:1935/3b6871bf2f344acaa6b397d09b476018",
    "stream_name": "alive",
    "static": false,
    "encryption": {},
    "playback_url": "https://bcovlive-a.akamaihd.net/3b6871bf2f344acaa6b397d09b476018/us-west-2/NA/playlist.m3u8",
    "playback_url_dvr": "https://bcovlive-a.akamaihd.net/3b6871bf2f344acaa6b397d09b476018/us-west-2/NA/playlist_dvr.m3u8"
}</code></pre>
	</li>
</ol>

<p>Ce travail créera 5 rendus <strong>basé</strong> au <a href="https://developer.apple.com/documentation/http_live_streaming/hls_authoring_specification_for_apple_devices">Recommandations Apple</a>.</p>
</section>

<section class="bcls-section">
<h2 id="Configure_your_encoder">Configurez votre encodeur</h2>

<p>Les étapes indiquées ici supposeront une <a href="https://www.elemental.com/products/aws-elemental-live">Live box élémentaire</a> encodeur, qui a été utilisé pour tester les étapes de ce didacticiel. Si vous avez un autre encodeur, les paramètres doivent être similaires.</p>

<p>Les paramètres les plus importants pour ce cas sont :</p>

<ul>
	<li>Configurer la source du timecode en tant qu'"horloge système"</li>
	<li>Réglez "Fréquence du code temporel OnFi" sur 1</li>
	<li>Vérifiez "l'insertion du code temporel" dans la vidéo</li>
	<li>Vivement recommandé: Framerate = suivre la source</li>
</ul>

<p>Voici la configuration que nous avons utilisée pour cette expérience :</p>

<figure class="bcls-figure"><img alt="elemental-live-job-config" title="Elemental live config" src="/assets/images/live-api/18697/elemental-live-job-config-v1-small.png" />
<figcaption class="bcls-caption--image">Configuration élémentaire en direct</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="test_playback">Tester la lecture</h2>

<p>Vous pouvez utiliser ceci <a href="https://videojs.github.io/videojs-contrib-hls/">Page de démonstration VideoJS HLS</a> pour tester la lecture, collez simplement la valeur <code translate="No">playback_url</code> renvoyé dans la réponse de la tâche de création :</p>

<figure class="bcls-figure"><img alt="videojs-hls-playback" title="VideoJS HLS playback demo page" src="/assets/images/live-api/18697/videojs-hls-playback-small.png" />
<figcaption class="bcls-caption--image">Page de démonstration de lecture VideoJS HLS</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="Youtube_live">Ajouter le flux en direct à YouTube en direct</h2>

<p>Nous supposons ici que vous avez un compte YouTube activé pour la diffusion en direct.</p>

<ol class="bcls-tasklist-restart">
	<li>
	<p>Cliquez sur <strong>aller vivre</strong> , et vous devriez voir :</p>

	<figure class="bcls-figure"><img alt="youtube-go-live" title="YouTube go live" src="/assets/images/live-api/18697/youtube-go-live-small.png" />
	<figcaption class="bcls-caption--image">YouTube en ligne</figcaption>
	</figure>
	</li>
	<li>
	<p>Cliquez sur "Encodeur live streaming" :</p>

	<figure class="bcls-figure"><img alt="youtube-encoder-live" title="YouTube encoder live source" src="/assets/images/live-api/18697/youtube-encoder-live-small.png" />
	<figcaption class="bcls-caption--image">Source en direct de l'encodeur YouTube</figcaption>
	</figure>
	</li>
	<li>
	<p>Configurez les métadonnées YouTube de votre événement en direct et utilisez les données "Configuration de l'encodeur" pour connecter le flux en direct Brightcove à YouTube :</p>

	<figure class="bcls-figure"><img alt="youtube-encoder-setup" title="YouTube encoder setup" src="/assets/images/live-api/18697/youtube-encoder-setup-small.png" />
	<figcaption class="bcls-caption--image">Configuration de l'encodeur YouTube</figcaption>
	</figure>
	</li>
	<li>
	<p>Maintenant que nous avons configuré YouTube en direct, nous allons créer la sortie RTMP correspondante à partir de notre travail en direct.</p>
	</li>
	<li>
	<p>Copiez le <span translate="No">boucle</span> commande ci-dessous dans un éditeur de texte :</p>

	<pre class="line-numbers">
<code class="language-bash" translate="No">curl -X POST \
  https://api.bcovlive.io/v1/jobs/{{bcov-live-job-id}}/rtmpouts \
  -H 'Content-Type: application/json' \
  -H 'x-api-key: {{bcov-live-api-key}}' \
  -d '{
  "url": "rtmp://a.rtmp.youtube.com/live2/{{youtube-secret-stream-name}}"
}'</code></pre>
	</li>
	<li>
	<p><strong>Remplacer:</strong></p>

	<ul>
		<li><code translate="No">{{bcov-live-job-id}}</code> avec votre identifiant de travail en direct Brightcove. Dans notre exemple, cette valeur serait <code translate="No">3b6871bf2f344acaa6b397d09b476018</code> - votre valeur, de la réponse à votre demande de création du live job, sera différente.</li>
		<li><code translate="No">{{bcov-live-api-key}}</code> pour votre clé API live Brightcove. Par exemple: <code translate="No">abcdfeg-this-is-a-fake-api-key-FgJajjasd12hJHsZ</code></li>
		<li><code translate="No">{{youtube-secret-stream-name}}</code> pour le nom du flux / la clé que YouTube fournit</li>
	</ul>
	</li>
	<li>Collez le code modifié dans votre application de ligne de commande et exécutez-le.</li>
	<li>
	<p>La réponse devrait ressembler à ceci :</p>

	<pre class="line-numbers">
<code class="language-json" translate="No">{
          "connection_info": {
            "host": "a.rtmp.youtube.com",
            "port": 1935,
            "application": "live2",
            "streamName": "{{youtube-secret-stream-name}}"
          },
          "duration_history": [],
          "rtmp_out_id": "27aacdfa5bcf4436ade0519e6a748aba",
          "stream_start": 1542902218238
        }</code></pre>
	</li>
	<li>
	<p>Pour tester la lecture YouTube, vous pouvez aller sur YouTube <strong>ma Chaîne</strong>:</p>

	<figure class="bcls-figure"><img alt="youtube-my-channel-playback" title="YouTube my channel playback" src="/assets/images/live-api/18697/youtube-my-channel-playback-small.png" />
	<figcaption class="bcls-caption--image">Lecture de ma chaîne YouTube</figcaption>
	</figure>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="facebook_live">Ajouter le flux en direct à Facebook en direct</h2>

<p>Nous supposons ici que vous avez un compte Facebook activé pour la diffusion en direct.</p>

<ol class="bcls-tasklist-restart">
	<li>
	<p>Cliquez sur <strong>Vidéo en direct</strong></p>
	</li>
	<li>
	<p>Cliquez sur <strong>relier</strong> et la clé de flux pour obtenir les données nécessaires pour connecter votre tâche en direct Brightcove :</p>

	<figure class="bcls-figure"><img alt="facebook-live-config" title="Facebook live config" src="/assets/images/live-api/18697/facebook-live-config-small.png" />
	<figcaption class="bcls-caption--image">Configuration en direct de Facebook</figcaption>
	</figure>
	</li>
	<li>
	<p>Ensuite, créez une sortie en direct pour le travail en direct Brightcove à l'aide de « l'URL du serveur » et de la « clé de diffusion » de Facebook. Copiez le <span translate="No">boucle</span> commande ci-dessous et collez-la dans un éditeur de texte :</p>

	<pre class="line-numbers">
<code class="language-bash" translate="No">curl -X POST \
  https://api.bcovlive.io/v1/jobs/{{bcov-live-job-id}}/rtmpouts \
  -H 'Content-Type: application/json' \
  -H 'x-api-key: {{bcov-live-api-key}}' \
  -d '{
  "url": "rtmp://live-api-s.facebook.com:80/rtmp/{{facebook-secret-stream-name}}"
}'</code></pre>
	</li>
	<li>
	<p><strong>Remplacer:</strong></p>

	<ul>
		<li><code translate="No">{{bcov-live-job-id}}</code> avec votre identifiant de travail en direct Brightcove. Dans notre exemple, cette valeur serait <code translate="No">3b6871bf2f344acaa6b397d09b476018</code> - votre valeur, de la réponse à votre demande de création du live job, sera différente.</li>
		<li><code translate="No">{{bcov-live-api-key}}</code> avec votre clé API live Brightcove. Par exemple: <code translate="No">abcdfeg-this-is-a-fake-api-key-FgJajjasd12hJHsZ</code></li>
		<li><code translate="No">{{facebook-secret-stream-name}}</code> avec votre nom de flux que Facebook vous donne</li>
	</ul>
	</li>
	<li>
	<p>La réponse devrait ressembler à ceci :</p>

	<pre class="line-numbers">
<code class="language-json" translate="No">{
  "connection_info": {
      "host": "live-api-s.facebook.com",
      "port": 80,
      "application": "rtmp",
      "streamName": "{{facebook-secret-stream-name}}"
  },
  "duration_history": [],
  "rtmp_out_id": "59323c3d1e2b44748755853193fb126c",
  "stream_start": 1542904101097
}</code></pre>
	</li>
	<li>
	<p>Pour tester votre flux Facebook Live, cliquez sur « Go Live » sur votre page Web Facebook.</p>
	<img alt="facebook-playback" title="Facebook playback" src="/assets/images/live-api/18697/facebook-playback-small.png" /></li>
</ol>
</section>
</article>